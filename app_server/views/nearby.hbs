
<head>
    <meta charset='utf-8'>
    <!-- Prevedeni in minimizirani slogi CSS verzije 4.5.2 -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
          integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z"
          crossorigin="anonymous">

    <!-- Podporni knjižnici jQuery in Popper -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
            integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
            crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
            integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
            crossorigin="anonymous"></script>

    <!-- Prevedena in minimizirana JavaScript koda verzije 4.5.2 -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"
            integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV"
            crossorigin="anonymous"></script>

    <!-- Leaflet CSS slogi -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
          integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
          crossorigin=""/>

    <!-- Leaflet knjižnica -->
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
            integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
            crossorigin=""></script>

</head>
<main>
    <section class="container panel">
        <div class="row">
            <div class="col-sm-6">
                <div class="card h-100">
                    <div class="card-body d-inline-flex flex-column">
                        <h5 class="card-title">Choose a vehicle nearby:</h5>
                        <p class="card-text">Select location on map:</p>
                        <div class="row w-100 mx-auto">
                            <!--<div class="col-4 overflow-auto" name="seznam" style="overflow-y: scroll; height: 100vh;"></div>-->
                            <div class="col-12" id="mapa_id" style="height: 50vh;
                             padding-left: 0px; padding-right: 0px; max-height: 100% !important;"></div>
                        </div>
                        <a href="#" class="button mt-auto button1" cars={{{cars}}} id="show_vehicles">Show available vehicles</a>
                    </div>
                </div>
            </div>
            <div class="col-sm-6">
                <div class="card h-100">
                    <div class="card-body d-inline-flex flex-column">
                        <h5 class="card-title">Weather forecast:</h5>
                        <p class="card-text">Weather forecast for selected area:</p>
                        <img src="/images/vreme.png" class="img-fluid" alt="...">
                        <a href="#" class="button mt-auto button1">Show weather forecast</a>
                    </div>
                </div>
            </div>
        </div>
    </section>
</main>
<script type='text/javascript'>

    var cars={{{cars}}}
    // seznam z markerji na mapi
    var markerji = [];

    // objekt mapa (Map)
    var mapa;

    const KONG_LAT = 46.050166466
    const KONG_LNG = 14.502164658

    // Ustvarimo objekt mapa ter dodamo osnovne lastnosti mapi
    mapa = L.map('mapa_id', {
        center: L.latLng(KONG_LAT, KONG_LNG),
        zoom: 12
    });

    // Ustvarimo prikazni sloj mape
    var layer = new L.TileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png');

    // Prikazni sloj dodamo na mapo
    mapa.addLayer(layer);

    document.getElementById("show_vehicles").addEventListener("click", function () {

        cars.forEach(function (car) {

            var marker = L.marker([car.LAT, car.LNG]).addTo(mapa);
            marker.bindPopup("<div>Tukaj se nahaja "+ car.make + " " + car.model + "</div>").openPopup();
        })

        markerji.push(marker);
    })

</script>
